{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/config/index.js","webpack:///./src/config/rethinkdb.js","webpack:///./src/core/database/rethinkdb/changefeeds.js","webpack:///./src/core/database/rethinkdb/connection.js","webpack:///./src/core/model/Schema.js","webpack:///./src/core/model/rethinkdb/index.js","webpack:///./src/index.js","webpack:///./src/middlewares.js","webpack:///./src/middlewares/database/rdb/connection/close.js","webpack:///./src/middlewares/database/rdb/connection/open.js","webpack:///./src/middlewares/errorHandler.js","webpack:///./src/middlewares/notFound.js","webpack:///./src/middlewares/okOutput.js","webpack:///./src/middlewares/sample.js","webpack:///./src/modules/home/index.js","webpack:///./src/modules/home/routes/index.js","webpack:///./src/modules/user/controllers/create-user.js","webpack:///./src/modules/user/controllers/delete-user.js","webpack:///./src/modules/user/controllers/fetch-user.js","webpack:///./src/modules/user/controllers/index.js","webpack:///./src/modules/user/controllers/update-user.js","webpack:///./src/modules/user/index.js","webpack:///./src/modules/user/models/Model.js","webpack:///./src/modules/user/models/create/User.js","webpack:///./src/modules/user/models/delete/User.js","webpack:///./src/modules/user/models/read/User.js","webpack:///./src/modules/user/models/read/Users.js","webpack:///./src/modules/user/models/schema.js","webpack:///./src/modules/user/models/update/User.js","webpack:///./src/modules/user/routes/create-user.js","webpack:///./src/modules/user/routes/delete-user.js","webpack:///./src/modules/user/routes/fetch-user.js","webpack:///./src/modules/user/routes/index.js","webpack:///./src/modules/user/routes/update-user.js","webpack:///./src/routes.js","webpack:///external \"@hapi/joi\"","webpack:///external \"http\"","webpack:///external \"koa\"","webpack:///external \"koa-bodyparser\"","webpack:///external \"koa-router\"","webpack:///external \"koa-static\"","webpack:///external \"rethinkdb\"","webpack:///external \"socket.io\""],"names":["server","port","static_dir","root","database","host","dbname","process","io","connection","rdbConnection","cursor","rdb","table","changes","run","each","err","row","console","log","JSON","stringify","emit","error","c","rethink","connect","config","db","Schema","constructor","options","Joi","object","Model","app","Koa","env","HOST","PORT","middlewares","http","createServer","callback","socket","sockets","on","id","rdbChangeFeeds","listen","use","errorHandler","notFound","okOutput","serve","bodyParser","sample","rdbOpenConnection","routes","allowedMethods","rdbCloseConnection","ctx","next","_rdbConn","close","status","type","body","message","throw","data","router","Router","index","route","middleware3","Date","now","middleware1","middleware2","get","request","name","undefined","slug","user","User","tableFound","hasTable","slugFound","getBySlug","timestamp","createdAt","result","insert","inserted","objectId","found","getById","deleteById","deleted","params","fetchBySlug","users","Users","fetch","getBySlugExcludeId","currentDocument","updateQuery","updatedAt","updateById","replaced","prefix","fetchUsers","fetchUser","createUser","updateUser","deleteUser","CoreModel","args","exists","tableList","contains","searchQuery","filter","nth","default","slugName","eq","ne","document","schema","validateAsync","returnChanges","delete","orderBy","desc","toArray","string","guid","trim","required","number","integer","update","post","controller","del","put","modules","home","module"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","'use strict'\n\nexport default {\n  server: {\n    port: 3030\n  },\n  static_dir: {\n    root: './static'\n  }\n}\n","'use strict'\n\nconst database = {\n  host: 'localhost',\n  port: 28015,\n  dbname: process.env.NODE_ENV === 'test' ? 'mydbtest' : 'mydb'\n}\n\nexport default {\n  host: database.host,\n  port: database.port,\n  dbname: database.dbname\n}\n","'use strict'\n\nimport rdb from 'rethinkdb'\nimport rdbConnection from 'core/database/rethinkdb/connection'\n\nexport default async (io) => {\n  try {\n    // Get the db connection.\n    const connection = await rdbConnection()\n\n    // Subscribe to user table's changefeed.\n    var cursor = await rdb.table('users')\n      .changes()\n      .run(connection)\n\n    cursor.each(function (err, row) {\n      if (err) {\n        throw err\n      }\n      console.log(JSON.stringify(row, null, 2))\n      io.emit('users.changefeeds', row)\n    })\n\n  } catch( err ) {\n    console.error(err);\n  }\n}\n","'use strict'\n\nimport config from 'config/rethinkdb'\nimport rethink from'rethinkdb'\n\nconst c = async() => {\n  // https://rethinkdb.com/api/javascript/connect/\n  const connection = await rethink.connect({\n    host: config.host,\n    port: config.port,\n    db: config.dbname\n  })\n  return connection;\n}\n\nexport default c\n","'use strict'\n\nimport Joi from '@hapi/joi'\n\nexport default class Schema {\n  constructor (options) {\n    return Joi.object(options)\n  }\n}\n","'use strict'\n\nimport rdb from 'rethinkdb'\n\nexport default class Model {\n  constructor (connection, table) {\n    this.table = table\n    this.connection = connection\n  }\n}\n","'use strict'\n\nimport Koa from 'koa'\nimport socket from 'socket.io'\nimport http from 'http'\nimport config from './config'\nimport middlewares from './middlewares'\nimport rdbChangeFeeds from 'core/database/rethinkdb/changefeeds'\n\nconst app = new Koa()\nconst host = process.env.HOST || '127.0.0.1'\nconst port = process.env.PORT || config.server.port\n\n// Middlewares are imported here.\nmiddlewares(app)\n\n// Hook socket.io up.\nconst server = http.createServer(app.callback())\nconst io = socket(server)\n\nio.sockets.on('connection', function(socket) {\n  console.log('a user connected: ' + socket.id)\n  socket.on('disconnect', () => {\n    console.log('user disconnected: ' + socket.id)\n  })\n})\n\n// Integrate socket and rethinkdb.\n// It should be done only once globally.\nrdbChangeFeeds(io)\n\n// app.listen(port, host)\nserver.listen(port, host)\n","'use strict'\n\n// Import node_modules middlewares.\n// Check other Koa official middlewares: https://github.com/koajs\nimport serve from 'koa-static'\nimport bodyParser from 'koa-bodyparser'\n\n// Import custom local middlewares.\nimport config from './config'\nimport routes from './routes'\nimport sample from './middlewares/sample'\nimport errorHandler from './middlewares/errorHandler'\nimport notFound from './middlewares/notFound'\nimport okOutput from './middlewares/okOutput'\nimport rdbOpenConnection from './middlewares/database/rdb/connection/open'\nimport rdbCloseConnection from './middlewares/database/rdb/connection/close'\n\nexport default (app) => {\n  // Catch and format the error in the upstream.\n  // https://github.com/koajs/koa/wiki/Error-Handling\n  app.use(errorHandler)\n  app.use(notFound)\n  app.use(okOutput)\n\n  // Static files are files that clients download as they are from the server.\n  // Create a new directory, public. Koa, by default doesn't allow you to\n  // serve static files.\n  // https://github.com/koajs/static\n  // https://www.tutorialspoint.com/koajs/koajs_static_files.htm\n  app.use(serve(config.static_dir.root))\n\n  // The parsed body will store in ctx.request.body\n  // If nothing was parsed, body will be an empty object {}\n  // https://github.com/koajs/bodyparser\n  // https://github.com/koajs/koa/issues/719\n  app.use(bodyParser())\n\n  // A sample middleware in a separate file.\n  app.use(sample)\n\n  // Middleware that will create a connection to the database.\n  app.use(rdbOpenConnection)\n\n  // Add routes.\n  app.use(routes.routes(), routes.allowedMethods())\n\n  // Middleware to close a connection to the database.\n  app.use(rdbCloseConnection)\n}\n","'use strict'\n\nimport config from 'config/rethinkdb'\nimport rdb from'rethinkdb'\n\n/**\n * Close the RethinkDB connection.\n * @param  {[type]}   ctx\n * @param  {Function} next\n */\nexport default async (ctx, next) => {\n  ctx._rdbConn.close()\n  await next()\n  // console.log('last middleware')\n}\n","'use strict'\n\nimport config from 'config/rethinkdb'\nimport rdb from'rethinkdb'\n\n/**\n * Create a RethinkDB connection, and save it in ctx._rdbConn\n * @param  {[type]}   ctx\n * @param  {Function} next\n */\nexport default async (ctx, next) => {\n  ctx._rdbConn = await rdb.connect({\n    host: config.host,\n    port: config.port,\n    db: config.dbname\n  })\n  await next()\n}\n","'use strict'\n\n// https://github.com/koajs/koa/wiki/Error-Handling\nexport default async (ctx, next) => {\n  try {\n    await next()\n  } catch (err) {\n    ctx.status = err.status || 500\n\n    // Decorate the error output.\n    ctx.type = 'json'\n    ctx.body = {\n      status: ctx.status,\n      message: err.message\n    }\n\n    ctx.app.emit('error', err, ctx)\n  }\n}\n","'use strict'\n\n// https://github.com/koajs/koa/wiki/Error-Handling\nexport default async (ctx, next) => {\n  await next()\n  // Handle 404 - throw it as an error.\n  if (ctx.status === 404) {\n    ctx.throw(404, 'Page not found')\n  }\n}\n","'use strict'\n\n// https://github.com/koajs/koa/wiki/Error-Handling\nexport default async (ctx, next) => {\n  await next()\n  // Use this when you want to format the 200 res further.\n  // e.g. {\"status\":200,\"data\":{\"message\":\"Hello home sample!\"}}\n  // else, you get, e.g. {\"message\":\"Hello home sample!\"}\n  if (ctx.status === 200) {\n    ctx.body = {\n      status: 200,\n      data: ctx.body\n    }\n  }\n}\n","'use strict'\n\nexport default async (ctx, next) => {\n  console.log('sample middleware')\n  await next()\n}\n","'use strict'\n\nimport Router from 'koa-router'\nimport index from './routes'\n\n// Better with prefix\n// https://www.npmjs.com/package/koa-router#router-prefixes\nconst router = new Router()\n\nconst routes = [index]\n\nfor (var route of routes) {\n  router.use(route.routes(), route.allowedMethods())\n}\n\nexport default router\n","'use strict'\n\nimport Router from 'koa-router'\n\nconst router = new Router()\n\nconst middleware3 = async (ctx, next) => {\n  console.log('Time started at: ', Date.now())\n  await next()\n}\n\nconst middleware1 = async(ctx, next) => {\n  console.log('I am the first. ')\n  await next()\n  console.log('I am the last. ')\n}\n\nconst middleware2 = async(ctx, next) => {\n  console.log('I am the second. ')\n  await next()\n  console.log('I am the third. ')\n}\n\n// Display hello world.\nrouter.get('/', middleware1, middleware2, middleware3, async (ctx, next) => {\n  ctx.type = 'json'\n  ctx.body = {\n    message: 'Hello World!'\n  }\n})\n\nexport default router\n","'use strict'\n\nimport User from '../models/create/User'\n\nexport default async (ctx) => {\n  // Get the parsed data.\n  let body = ctx.request.body || {}\n\n  if (body.name === undefined) {\n    ctx.throw(400, 'name is undefined')\n  }\n  if (body.slug === undefined) {\n    ctx.throw(400, 'slug is undefined')\n  }\n  if (body.name === '') {\n    ctx.throw(400, 'name is required')\n  }\n  if (body.slug === '') {\n    ctx.throw(400, 'slug is required')\n  }\n\n  // Create a user instance.\n  let user = new User(ctx._rdbConn, 'user')\n\n  // Throw the error if the table does not exist.\n  let tableFound = await user.hasTable()\n  if (tableFound === false) {\n    ctx.throw(500, 'users table does not exist')\n  }\n\n  // Check if the provided slug is taken.\n  let slugFound = await user.getBySlug(body.slug)\n  if (slugFound) {\n    ctx.throw(404, 'slug has been taken')\n  }\n\n  // Insert a doc.\n  // Current timestamp.\n  let timestamp = Date.now()\n  let options = {\n    name: body.name,\n    slug: body.slug,\n    createdAt: timestamp,\n    // example fields that won't be injected into the document:\n    // username: 'marymoe',\n    // password: '123123'\n  }\n  let result = await user.insert(options)\n  if (result.inserted !== 1) {\n    ctx.throw(404, 'insert user failed')\n  }\n\n  return result\n}\n","'use strict'\n\nimport User from '../models/delete/User'\n\nexport default async (ctx) => {\n  // Get the parsed data.\n  let body = ctx.request.body || {}\n\n  if (body.id === undefined) {\n    ctx.throw(400, 'id is undefined')\n  }\n  if (body.id === '') {\n    ctx.throw(400, 'id is required')\n  }\n\n  let objectId = body.id\n\n  // Create a user instance.\n  let user = new User(ctx._rdbConn, 'user')\n\n  // Throw the error if the table does not exist.\n  let tableFound = await user.hasTable()\n  if (tableFound === false) {\n    ctx.throw(500, 'users table does not exist')\n  }\n\n  // Find one doc.\n  const found = await user.getById(objectId)\n  if (!found) {\n    ctx.throw(404, 'user does not exist')\n  }\n\n  let result = await user.deleteById(objectId)\n  if (result.deleted !== 1) {\n    ctx.throw(404, 'delete user failed')\n  }\n\n  return result\n}\n","'use strict'\n\nimport User from '../models/read/User'\n\nexport default async (ctx) => {\n  const slug = ctx.params.slug\n\n  // Create a user instance.\n  let user = new User(ctx._rdbConn, 'user')\n\n  // Throw the error if the table does not exist.\n  let tableFound = await user.hasTable()\n  if (tableFound === false) {\n    ctx.throw(500, 'users table does not exist')\n  }\n\n  let result = await user.fetchBySlug(slug)\n  if (!result) {\n    ctx.throw(404, 'user not found')\n  }\n  return result\n}\n\n","'use strict'\n\nimport Users from '../models/read/Users'\n\nexport default async (ctx) => {\n  // Create a user instance.\n  let users = new Users(ctx._rdbConn, 'user')\n\n  // Throw the error if the table does not exist.\n  let tableFound = await users.hasTable()\n  if (tableFound === false) {\n    ctx.throw(500, 'users table does not exist')\n  }\n\n  let result = await users.fetch()\n  return result\n}\n","'use strict'\n\nimport User from '../models/update/User'\n\nexport default async (ctx) => {\n  // Get the parsed data.\n  let body = ctx.request.body || {}\n\n  if (body.id === undefined) {\n    ctx.throw(400, 'id is undefined')\n  }\n  if (body.name === undefined) {\n    ctx.throw(400, 'name is undefined')\n  }\n  if (body.slug === undefined) {\n    ctx.throw(400, 'slug is undefined')\n  }\n  if (body.id === '') {\n    ctx.throw(400, 'id is required')\n  }\n  if (body.name === '') {\n    ctx.throw(400, 'name is required')\n  }\n  if (body.slug === '') {\n    ctx.throw(400, 'slug is required')\n  }\n\n  let objectId = body.id\n\n  // Create a user instance.\n  let user = new User(ctx._rdbConn, 'user')\n\n  // Throw the error if the table does not exist.\n  let tableFound = await user.hasTable()\n  if (tableFound === false) {\n    ctx.throw(500, 'users table does not exist')\n  }\n\n  // Check if the provided slug is taken.\n  // Find one doc except itself.\n  let slugFound = await user.getBySlugExcludeId(body.slug, objectId)\n  if (slugFound) {\n    ctx.throw(404, 'slug has been taken')\n  }\n\n  // Get the current doc.\n  let currentDocument = await user.getById(objectId)\n\n  // Prepare the update query.\n  let timestamp = Date.now()\n  let updateQuery = {\n    name: body.name,\n    slug: body.slug,\n    updatedAt: timestamp,\n    // example fields that won't be injected into the document:\n    // username: 'marymoe',\n    // password: '123123'\n  }\n\n  // Merge two objects.\n  let options = {...currentDocument, ...updateQuery}\n\n  // Update document by id.\n  let result = await user.updateById(options, objectId)\n  if (result.replaced !== 1) {\n    ctx.throw(404, 'update user failed')\n  }\n\n  return result\n}\n","'use strict'\n\nimport Router from 'koa-router'\nimport fetchUsers from './routes'\nimport fetchUser from './routes/fetch-user'\nimport createUser from './routes/create-user'\nimport updateUser from './routes/update-user'\nimport deleteUser from './routes/delete-user'\n\n// Better with prefix\n// https://www.npmjs.com/package/koa-router#router-prefixes\nconst router = new Router({\n  prefix: '/users'\n})\n\nconst routes = [\n  fetchUsers,\n  fetchUser,\n  createUser,\n  updateUser,\n  deleteUser\n]\nfor (var route of routes) {\n  router.use(route.routes(), route.allowedMethods())\n}\n\nexport default router\n","'use strict'\n\nimport rdb from 'rethinkdb'\nimport CoreModel from 'model/rethinkdb'\nimport schema from './schema'\n\nexport default class Model extends CoreModel {\n  constructor (...args) {\n    super(...args)\n  }\n\n  async hasTable () {\n    let exists = await rdb.tableList()\n      .contains(this.table)\n      .run(this.connection)\n\n    return exists\n  }\n\n  async getBySlug (slug) {\n    let searchQuery = {\n      slug: slug\n    }\n    let result = await rdb.table(this.table)\n      .filter(searchQuery)\n      .nth(0) // query for a stream/array element by its position\n      .default(null) // will return null if no user found.\n      .run(this.connection)\n\n    return result\n  }\n\n  async getBySlugExcludeId (slugName, objectId) {\n    // Find one doc except itself.\n    // https://rethinkdb.com/api/javascript/filter\n    // https://rethinkdb.com/api/javascript/ne\n    let result = await rdb.table(this.table)\n      .filter(\n        rdb.row('slug').eq(slugName) // equal\n      )\n      .filter(\n        rdb.row('id').ne(objectId) // but not equal itself\n      )\n      .nth(0) // query for a stream/array element by its position\n      .default(null) // will return null if no user found.\n      .run(this.connection)\n\n    return result\n  }\n\n  async getById (objectId) {\n    let result = await rdb.table(this.table)\n      .get(objectId)\n      .run(this.connection)\n\n    return result\n  }\n}\n","'use strict'\n\nimport rdb from 'rethinkdb'\nimport schema from '../schema'\nimport Model from '../Model'\n\nexport default class User extends Model {\n  constructor (...args) {\n    super(...args)\n  }\n\n  async insert (options) {\n    // Enforce the schema.\n    let document = await schema.validateAsync(options)\n\n    // Insert a doc.\n    // https://rethinkdb.com/api/javascript/insert\n    let result = await rdb.table(this.table)\n      .insert(document, {returnChanges: true})\n      .run(this.connection)\n\n    return result\n  }\n}\n","'use strict'\n\nimport rdb from 'rethinkdb'\nimport Model from '../Model'\n\nexport default class User extends Model {\n  constructor (...args) {\n    super(...args)\n  }\n\n  async deleteById (objectId) {\n    // Delete a single document by id.\n    // https://rethinkdb.com/api/javascript/delete/\n    let result = await rdb.table(this.table)\n      .get(objectId)\n      .delete()\n      .run(this.connection)\n\n    return result\n  }\n}\n","'use strict'\n\nimport rdb from 'rethinkdb'\nimport Model from '../Model'\n\nexport default class User extends Model {\n  constructor (...args) {\n    super(...args)\n  }\n\n  async fetchBySlug (slug) {\n    // Prepare query.\n    let searchQuery = {\n      slug: slug\n    }\n\n    // Retrieve documents by filter.\n    // https://rethinkdb.com/api/javascript/filter/\n    let result = await rdb.table(this.table)\n      .filter(searchQuery)\n      .nth(0) // query for a stream/array element by its position\n      .default(null) // will return null if no user found.\n      .run(this.connection)\n\n    return result\n  }\n}\n","'use strict'\n\nimport rdb from 'rethinkdb'\nimport Model from '../Model'\n\nexport default class Users extends Model {\n  constructor (...args) {\n    super(...args)\n  }\n\n  async fetch () {\n    let cursor = await rdb.table(this.table)\n      .orderBy(rdb.desc('createdAt')) // latest first\n      .run(this.connection)\n\n    let result = await cursor.toArray()\n\n    return result\n  }\n}\n","'use strict'\n\nimport Joi from '@hapi/joi'\nimport Schema from 'model/Schema'\n\n// https://hapi.dev/family/joi/?v=16.1.7\nexport default new Schema({\n  id: Joi.string()\n    .guid(),\n\n  slug: Joi.string()\n    .trim()\n    // .lowercase()\n    .required(),\n\n  name: Joi.string()\n    .trim()\n    .required(),\n\n  // username: Joi.string()\n  //   .alphanum()\n  //   .min(3)\n  //   .max(30)\n  //   .required(),\n\n  // password: Joi.string()\n  //   .pattern(/^[a-zA-Z0-9]{3,30}$/)\n  //   .required(),\n\n  // repeatPassword: Joi.ref('password'),\n\n  // Number only.\n  createdAt: Joi.number()\n    .integer()\n    .required(),\n\n  // Number or null.\n  updatedAt: [\n    Joi.number()\n      .integer(),\n    null\n  ]\n})\n","'use strict'\n\nimport rdb from 'rethinkdb'\nimport schema from '../schema'\nimport Model from '../Model'\n\nexport default class User extends Model {\n  constructor (...args) {\n    super(...args)\n  }\n\n  async updateById (options, objectId) {\n    // Enforce the schema.\n    let document = await schema.validateAsync(options)\n\n    // Update document by id.\n    // https://rethinkdb.com/api/javascript/update/\n    let result = await rdb.table(this.table)\n      .get(objectId)\n      .update(document, {returnChanges: true})\n      .run(this.connection)\n\n    return result\n  }\n}\n","'use strict'\n\nimport Router from 'koa-router'\nimport controller from '../controllers/create-user'\n\nconst router = new Router()\n\n// Add a user.\nrouter.post('/user', async (ctx, next) => {\n  try {\n    const result = await controller(ctx, next)\n\n    ctx.type = 'json'\n    ctx.body = result\n\n    await next()\n\n  } catch (err) {\n    // Get the error message and do something.\n    // console.log(err.message)\n\n    // Throw the error.\n    ctx.throw(500, err)\n  }\n})\n\nexport default router\n","'use strict'\n\nimport Router from 'koa-router'\nimport controller from '../controllers/delete-user'\n\nconst router = new Router()\n\n// Delete a user.\nrouter.del('/user', async (ctx, next) => {\n  try {\n    const result = await controller(ctx, next)\n\n    ctx.type = 'json'\n    ctx.body = result\n\n    await next()\n\n  } catch (err) {\n    // Get the error message and do something.\n    // console.log(err.message)\n\n    // Throw the error.\n    ctx.throw(500, err)\n  }\n})\n\nexport default router\n","'use strict'\n\nimport Router from 'koa-router'\nimport controller from '../controllers/fetch-user'\n\nconst router = new Router()\n\n// Get the user by slug.\nrouter.get('/:slug', async (ctx, next) => {\n  try {\n    const result = await controller(ctx, next)\n\n    ctx.type = 'json'\n    ctx.body = result\n\n    await next()\n\n  } catch (err) {\n    // Get the error message and do something.\n    // console.log(err.message)\n\n    // Throw the error.\n    ctx.throw(500, err)\n  }\n})\n\nexport default router\n","'use strict'\n\nimport Router from 'koa-router'\nimport controller from '../controllers/index'\n\nconst router = new Router()\n\n// Get all users.\nrouter.get('/', async (ctx, next) => {\n  try {\n    const result = await controller(ctx, next)\n\n    ctx.type = 'json'\n    ctx.body = result\n\n    await next()\n\n  } catch (err) {\n    // Get the error message and do something.\n    // console.log(err.message)\n\n    // Throw the error.\n    ctx.throw(500, err)\n  }\n})\n\nexport default router\n","'use strict'\n\nimport Router from 'koa-router'\nimport controller from '../controllers/update-user'\n\nconst router = new Router()\n\n// Update a user.\nrouter.put('/user', async (ctx, next) => {\n  try {\n    const result = await controller(ctx)\n\n    ctx.type = 'json'\n    ctx.body = result\n\n    await next()\n\n  } catch (err) {\n    // Get the error message and do something.\n    // console.log(err.message)\n\n    // Throw the error.\n    ctx.throw(500, err)\n  }\n})\n\nexport default router\n","'use strict'\n\nimport Router from 'koa-router'\n\n// Import routes from different modules.\nimport home from './modules/home'\nimport user from './modules/user'\n\nconst router = new Router({\n  // prefix: '/public'\n})\n\n// https://stackoverflow.com/questions/30285683/how-can-i-split-my-koa-routes-into-separate-files\nconst modules = [home, user]\nfor (var module of modules) {\n  router.use(module.routes(), module.allowedMethods())\n}\n\nexport default router\n","module.exports = require(\"@hapi/joi\");","module.exports = require(\"http\");","module.exports = require(\"koa\");","module.exports = require(\"koa-bodyparser\");","module.exports = require(\"koa-router\");","module.exports = require(\"koa-static\");","module.exports = require(\"rethinkdb\");","module.exports = require(\"socket.io\");"],"sourceRoot":""}